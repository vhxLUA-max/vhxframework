--[[
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              NexusUI  v2.0  â€”  by NexusUI Team           â•‘
â•‘   Dark Glass UI Library Â· Full Rayfield Feature Parity   â•‘
â•‘   ScriptHub Ready Â· Executor Compatible Â· Modular        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Functions:
    CreateWindow, CreateTab, CreateSection,
    CreateButton, CreateToggle, CreateSlider,
    CreateInput, CreateDropdown, CreateColorPicker,
    CreateKeybind, CreateLabel, CreateParagraph,
    Notify, Dialog, Destroy / Unload,
    LoadingScreen, KeySystem, ConfigurationSaving
--]]

local NexusUI     = {}
local TweenService     = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService       = game:GetService("RunService")
local Players          = game:GetService("Players")
local TextService      = game:GetService("TextService")
local CoreGui          = game:GetService("CoreGui")
local Debris           = game:GetService("Debris")
local LocalPlayer      = Players.LocalPlayer
local Mouse            = LocalPlayer:GetMouse()

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- THEME SYSTEM
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
NexusUI.Theme = {
    Background    = Color3.fromRGB(11, 11, 17),
    Surface       = Color3.fromRGB(19, 19, 29),
    SurfaceLight  = Color3.fromRGB(26, 26, 40),
    SurfaceHover  = Color3.fromRGB(32, 32, 50),
    Sidebar       = Color3.fromRGB(14, 14, 22),
    Accent        = Color3.fromRGB(115, 88, 255),
    AccentHover   = Color3.fromRGB(145, 115, 255),
    AccentGlow    = Color3.fromRGB(75, 52, 175),
    AccentDark    = Color3.fromRGB(45, 30, 110),
    Success       = Color3.fromRGB(60, 200, 120),
    Warning       = Color3.fromRGB(255, 180, 50),
    Danger        = Color3.fromRGB(235, 65, 65),
    Text          = Color3.fromRGB(228, 228, 242),
    TextDim       = Color3.fromRGB(138, 138, 162),
    TextMuted     = Color3.fromRGB(75, 75, 98),
    Border        = Color3.fromRGB(35, 35, 56),
    BorderBright  = Color3.fromRGB(55, 55, 82),
    InputBg       = Color3.fromRGB(14, 14, 22),
    ButtonBg      = Color3.fromRGB(28, 28, 44),
    ButtonHover   = Color3.fromRGB(42, 40, 68),
    ButtonClick   = Color3.fromRGB(20, 18, 38),
    SectionBg     = Color3.fromRGB(15, 15, 24),
    Separator     = Color3.fromRGB(28, 28, 46),
    ToggleOff     = Color3.fromRGB(38, 38, 58),
    ToggleOn      = Color3.fromRGB(115, 88, 255),
    SliderFill    = Color3.fromRGB(115, 88, 255),
    SliderBg      = Color3.fromRGB(30, 30, 48),
    Radius        = UDim.new(0, 12),
    RadiusMd      = UDim.new(0, 9),
    RadiusSm      = UDim.new(0, 7),
    RadiusXs      = UDim.new(0, 5),
    RadiusFull    = UDim.new(1, 0),
    SidebarW      = 58,
    WinW          = 660,
    WinH          = 460,
    TFast         = TweenInfo.new(0.13, Enum.EasingStyle.Quad,  Enum.EasingDirection.Out),
    TMed          = TweenInfo.new(0.22, Enum.EasingStyle.Quart, Enum.EasingDirection.Out),
    TSlow         = TweenInfo.new(0.38, Enum.EasingStyle.Quart, Enum.EasingDirection.Out),
    TSpring       = TweenInfo.new(0.45, Enum.EasingStyle.Back,  Enum.EasingDirection.Out),
}
local T = NexusUI.Theme

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- FLAG / CONFIG SYSTEM
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
NexusUI.Flags = {}

local function SetFlag(flag, value)
    if flag and flag ~= "" then
        NexusUI.Flags[flag] = value
    end
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- UTILITY
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
local function Tw(obj, info, props) TweenService:Create(obj, info, props):Play() end

local function Corner(p, r)
    local c = Instance.new("UICorner"); c.CornerRadius = r or T.Radius; c.Parent = p; return c
end
local function Stroke(p, col, th, tr)
    local s = Instance.new("UIStroke"); s.Color = col or T.Border
    s.Thickness = th or 1; s.Transparency = tr or 0
    s.ApplyStrokeMode = Enum.ApplyStrokeMode.Border; s.Parent = p; return s
end
local function Pad(p, t, r, b, l)
    local u = Instance.new("UIPadding")
    u.PaddingTop = UDim.new(0,t or 10); u.PaddingRight  = UDim.new(0,r or 10)
    u.PaddingBottom = UDim.new(0,b or 10); u.PaddingLeft = UDim.new(0,l or 10)
    u.Parent = p; return u
end
local function List(p, sp, dir, ha, va)
    local l = Instance.new("UIListLayout"); l.Padding = UDim.new(0, sp or 8)
    l.FillDirection = dir or Enum.FillDirection.Vertical
    l.HorizontalAlignment = ha or Enum.HorizontalAlignment.Left
    l.VerticalAlignment   = va or Enum.VerticalAlignment.Top
    l.SortOrder = Enum.SortOrder.LayoutOrder; l.Parent = p; return l
end
local function Frame(p, sz, pos, col, tr)
    local f = Instance.new("Frame"); f.Size = sz or UDim2.new(1,0,0,40)
    f.Position = pos or UDim2.new(0,0,0,0); f.BackgroundColor3 = col or T.Surface
    f.BackgroundTransparency = tr or 0; f.BorderSizePixel = 0; f.Parent = p; return f
end
local function Lbl(p, txt, sz, col, fnt, xa)
    local l = Instance.new("TextLabel"); l.Text = txt or ""; l.TextSize = sz or 13
    l.TextColor3 = col or T.Text; l.Font = fnt or Enum.Font.GothamMedium
    l.BackgroundTransparency = 1; l.TextXAlignment = xa or Enum.TextXAlignment.Left
    l.TextYAlignment = Enum.TextYAlignment.Center; l.Size = UDim2.new(1,0,0,20)
    l.Parent = p; return l
end
local function Btn(p, sz, pos)
    local b = Instance.new("TextButton"); b.Size = sz or UDim2.new(1,0,1,0)
    b.Position = pos or UDim2.new(0,0,0,0); b.BackgroundTransparency = 1
    b.Text = ""; b.Parent = p; return b
end
local function Shadow(p, tr)
    local s = Instance.new("ImageLabel"); s.Name = "Shadow"
    s.AnchorPoint = Vector2.new(0.5,0.5); s.BackgroundTransparency = 1
    s.Position = UDim2.new(0.5,0,0.5,6); s.Size = UDim2.new(1,46,1,46)
    s.ZIndex = (p.ZIndex or 1) - 1; s.Image = "rbxassetid://6014261993"
    s.ImageColor3 = Color3.new(0,0,0); s.ImageTransparency = tr or 0.45
    s.ScaleType = Enum.ScaleType.Slice; s.SliceCenter = Rect.new(49,49,450,450)
    s.Parent = p; return s
end
local function Ripple(host)
    local r = Instance.new("Frame"); r.BackgroundColor3 = Color3.new(1,1,1)
    r.BackgroundTransparency = 0.82; r.BorderSizePixel = 0
    r.AnchorPoint = Vector2.new(0.5,0.5); r.Size = UDim2.new(0,0,0,0)
    local abs = host.AbsolutePosition; local sz = host.AbsoluteSize
    r.Position = UDim2.new((Mouse.X-abs.X)/sz.X,0,(Mouse.Y-abs.Y)/sz.Y,0)
    r.ZIndex = (host.ZIndex or 1)+6; Corner(r, T.RadiusFull); r.Parent = host
    Tw(r, TweenInfo.new(0.42,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),
        {Size=UDim2.new(0,sz.X*2.8,0,sz.X*2.8), BackgroundTransparency=1})
    Debris:AddItem(r, 0.5)
end

local function MakeDraggable(handle, root)
    local drag, ds, sp = false, nil, nil
    handle.InputBegan:Connect(function(i)
        if i.UserInputType == Enum.UserInputType.MouseButton1 then
            drag=true; ds=i.Position; sp=root.Position
        end
    end)
    UserInputService.InputChanged:Connect(function(i)
        if drag and i.UserInputType == Enum.UserInputType.MouseMovement then
            local d = i.Position-ds
            root.Position = UDim2.new(sp.X.Scale,sp.X.Offset+d.X,sp.Y.Scale,sp.Y.Offset+d.Y)
        end
    end)
    UserInputService.InputEnded:Connect(function(i)
        if i.UserInputType == Enum.UserInputType.MouseButton1 then drag=false end
    end)
end

local function NewGui(name, order)
    local g = Instance.new("ScreenGui"); g.Name = name
    g.ResetOnSpawn = false; g.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    g.DisplayOrder = order or 999
    local ok = pcall(function() g.Parent = CoreGui end)
    if not ok then g.Parent = LocalPlayer:WaitForChild("PlayerGui") end
    return g
end

local function GetTextW(txt, sz, fnt)
    return TextService:GetTextSize(txt, sz, fnt or Enum.Font.GothamMedium, Vector2.new(9999,50)).X
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- LOADING SCREEN
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function NexusUI:LoadingScreen(config)
    config = config or {}
    local LG = NewGui("NexusUI_Loading", 1000)
    local BG = Frame(LG, UDim2.new(1,0,1,0), nil, Color3.fromRGB(8,8,14), 0)
    BG.AnchorPoint = Vector2.new(0.5,0.5)
    BG.Position = UDim2.new(0.5,0,0.5,0)

    -- Grid overlay
    local Grid = Instance.new("ImageLabel"); Grid.Size = UDim2.new(1,0,1,0)
    Grid.BackgroundTransparency = 1; Grid.Image = "rbxassetid://9968344802"
    Grid.ImageTransparency = 0.92; Grid.ScaleType = Enum.ScaleType.Tile
    Grid.TileSize = UDim2.new(0,60,0,60); Grid.Parent = BG

    local Center = Frame(BG, UDim2.new(0,320,0,180), UDim2.new(0.5,-160,0.5,-90), Color3.new(0,0,0), 1)
    List(Center, 14, nil, Enum.HorizontalAlignment.Center)

    -- Logo ring
    local Ring = Frame(Center, UDim2.new(0,64,0,64), nil, T.AccentDark, 0)
    Ring.AnchorPoint = Vector2.new(0.5,0); Corner(Ring, T.RadiusMd); Stroke(Ring, T.Accent, 2)
    local RingLbl = Lbl(Ring, "VhX", 28, T.Accent, Enum.Font.GothamBold, Enum.TextXAlignment.Center)
    RingLbl.Size = UDim2.new(1,0,1,0)

    local TitleL = Lbl(Center, config.Title or "NexusUI", 22, T.Text, Enum.Font.GothamBold, Enum.TextXAlignment.Center)
    TitleL.Size = UDim2.new(1,0,0,28)
    local SubL = Lbl(Center, config.Subtitle or "Loading...", 13, T.TextDim, Enum.Font.Gotham, Enum.TextXAlignment.Center)
    SubL.Size = UDim2.new(1,0,0,18)

    -- Progress bar
    local PBg = Frame(Center, UDim2.new(0.8,0,0,4), nil, T.Border, 0)
    PBg.AnchorPoint = Vector2.new(0.5,0); Corner(PBg, T.RadiusFull)
    local PBar = Frame(PBg, UDim2.new(0,0,1,0), nil, T.Accent, 0); Corner(PBar, T.RadiusFull)

    -- Animate
    Tw(Ring, TweenInfo.new(1.4,Enum.EasingStyle.Sine,Enum.EasingDirection.InOut,math.huge,true),
        {BackgroundColor3=T.AccentGlow})
    Tw(PBar, TweenInfo.new(1.8,Enum.EasingStyle.Quart,Enum.EasingDirection.InOut), {Size=UDim2.new(1,0,1,0)})

    return {
        SetText = function(_, t) SubL.Text = t end,
        Destroy = function()
            Tw(BG, T.TMed, {BackgroundTransparency=1})
            task.wait(0.25); LG:Destroy()
        end
    }
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- KEY SYSTEM
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function NexusUI:KeySystem(config)
    config = config or {}
    local Keys    = config.Keys or {"NEXUS"}
    local Title   = config.Title or "Key Required"
    local Hint    = config.Hint or "Enter the key to continue"
    local Success = config.GrabKeyFromSite and config.GrabKeyFromSite() or nil

    local resolved = false
    local passed   = false

    local KG = NewGui("NexusUI_Key", 1001)
    local Overlay = Frame(KG, UDim2.new(1,0,1,0), nil, Color3.fromRGB(0,0,0), 0.5)

    local Card = Frame(KG, UDim2.new(0,380,0,220), UDim2.new(0.5,-190,0.5,-110), T.Surface, 0)
    Corner(Card, T.Radius); Stroke(Card, T.Border); Shadow(Card, 0.3)
    Pad(Card, 24, 24, 24, 24)
    local CList = List(Card, 12, nil, Enum.HorizontalAlignment.Center)

    Lbl(Card, Title, 16, T.Text, Enum.Font.GothamBold, Enum.TextXAlignment.Center).Size = UDim2.new(1,0,0,22)
    Lbl(Card, Hint,  11, T.TextDim, Enum.Font.Gotham, Enum.TextXAlignment.Center).Size  = UDim2.new(1,0,0,16)

    local InputBox = Frame(Card, UDim2.new(1,0,0,40), nil, T.InputBg, 0)
    Corner(InputBox, T.RadiusSm); Stroke(InputBox, T.Border)
    Pad(InputBox, 0, 12, 0, 12)
    local TB = Instance.new("TextBox"); TB.Size = UDim2.new(1,0,1,0)
    TB.BackgroundTransparency = 1; TB.Text = ""; TB.PlaceholderText = "Enter key..."
    TB.PlaceholderColor3 = T.TextMuted; TB.TextColor3 = T.Text
    TB.TextSize = 13; TB.Font = Enum.Font.GothamMedium; TB.ClearTextOnFocus = false
    TB.Parent = InputBox

    local StatusL = Lbl(Card, "", 11, T.TextMuted, Enum.Font.Gotham, Enum.TextXAlignment.Center)
    StatusL.Size = UDim2.new(1,0,0,16)

    local SubmitF = Frame(Card, UDim2.new(1,0,0,38), nil, T.Accent, 0)
    Corner(SubmitF, T.RadiusSm)
    Lbl(SubmitF, "Confirm Key", 13, Color3.new(1,1,1), Enum.Font.GothamBold, Enum.TextXAlignment.Center).Size = UDim2.new(1,0,1,0)
    local SubmitBtn = Btn(SubmitF)

    local function TryKey(k)
        local valid = false
        for _, v in ipairs(Keys) do
            if v:lower() == k:lower() then valid = true break end
        end
        if Success and k:lower() == Success:lower() then valid = true end
        if valid then
            passed = true; resolved = true
            Tw(InputBox, T.TFast, {BackgroundColor3 = Color3.fromRGB(20,45,28)})
            Stroke(InputBox):Destroy(); Stroke(InputBox, T.Success)
            StatusL.Text = "âœ“  Access granted"; StatusL.TextColor3 = T.Success
            task.wait(0.8)
            Tw(Card, T.TMed, {BackgroundTransparency=1, Size=UDim2.new(0,380,0,0)})
            Tw(Overlay, T.TMed, {BackgroundTransparency=1})
            task.wait(0.25); KG:Destroy()
        else
            Tw(InputBox, T.TFast, {BackgroundColor3 = Color3.fromRGB(45,18,18)})
            StatusL.Text = "âœ—  Invalid key"; StatusL.TextColor3 = T.Danger
            task.delay(0.3, function()
                Tw(InputBox, T.TFast, {BackgroundColor3 = T.InputBg})
            end)
        end
    end

    SubmitBtn.MouseButton1Click:Connect(function() TryKey(TB.Text) end)
    TB.FocusLost:Connect(function(enter) if enter then TryKey(TB.Text) end end)
    SubmitBtn.MouseEnter:Connect(function() Tw(SubmitF, T.TFast, {BackgroundColor3 = T.AccentHover}) end)
    SubmitBtn.MouseLeave:Connect(function() Tw(SubmitF, T.TFast, {BackgroundColor3 = T.Accent}) end)

    -- open animation
    Card.Size = UDim2.new(0,380,0,0); Card.BackgroundTransparency = 1
    Tw(Card, T.TSpring, {Size=UDim2.new(0,380,0,220), BackgroundTransparency=0})

    -- block until resolved
    repeat RunService.Heartbeat:Wait() until resolved
    return passed
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- NOTIFICATION
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
local notifStack = {}
local NOTIF_H    = 82
local NOTIF_GAP  = 8
local NOTIF_X    = -306

local function RepositionNotifs()
    for i, nf in ipairs(notifStack) do
        local targetY = -(NOTIF_H + NOTIF_GAP) * i
        Tw(nf, T.TMed, {Position = UDim2.new(1, NOTIF_X, 1, targetY)})
    end
end

function NexusUI:Notify(config)
    config = config or {}
    local nTitle = config.Title    or "Notice"
    local nMsg   = config.Content  or config.Message or ""
    local nDur   = config.Duration or 4
    local nImg   = config.Image    or nil

    local NG = NewGui("NexusUI_Notif_"..tostring(tick()), 1002)
    local NF = Frame(NG, UDim2.new(0,290,0,NOTIF_H), UDim2.new(1, NOTIF_X, 1, -(NOTIF_H+8)), T.Surface, 0)
    Corner(NF, T.RadiusSm); Stroke(NF, T.BorderBright, 1, 0.4); Shadow(NF, 0.55)
    NF.ClipsDescendants = false

    -- accent left bar
    local AccBar = Frame(NF, UDim2.new(0,3,1,-20), UDim2.new(0,0,0,10), T.Accent, 0); Corner(AccBar, T.RadiusFull)

    local Content = Frame(NF, UDim2.new(1,-16,1,0), UDim2.new(0,14,0,0), Color3.new(0,0,0), 1)
    List(Content, 4, nil, Enum.HorizontalAlignment.Left, Enum.VerticalAlignment.Center)

    local NT = Lbl(Content, nTitle, 13, T.Text,    Enum.Font.GothamBold);  NT.Size = UDim2.new(1,0,0,18)
    local NM = Lbl(Content, nMsg,   11, T.TextDim, Enum.Font.Gotham);      NM.Size = UDim2.new(1,0,0,32)
    NM.TextWrapped = true; NM.TextYAlignment = Enum.TextYAlignment.Top

    -- progress bar
    local PBg  = Frame(NF, UDim2.new(1,0,0,2), UDim2.new(0,0,1,-2), T.Border, 0); Corner(PBg, T.RadiusFull)
    local PBar = Frame(PBg, UDim2.new(1,0,1,0), nil, T.Accent, 0); Corner(PBar, T.RadiusFull)

    -- close btn
    local XBtn = Frame(NF, UDim2.new(0,18,0,18), UDim2.new(1,-22,0,7), Color3.new(0,0,0), 1)
    local XLbl = Lbl(XBtn, "Ã—", 15, T.TextMuted, Enum.Font.GothamBold, Enum.TextXAlignment.Center)
    XLbl.Size = UDim2.new(1,0,1,0)
    local XB = Btn(XBtn)

    table.insert(notifStack, 1, NF)
    RepositionNotifs()
    Tw(NF, T.TSpring, {Position = UDim2.new(1, NOTIF_X, 1, -(NOTIF_H+8))})
    Tw(PBar, TweenInfo.new(nDur, Enum.EasingStyle.Linear), {Size = UDim2.new(0,0,1,0)})

    local function Dismiss()
        Tw(NF, T.TMed, {Position = UDim2.new(1, 20, 1, -(NOTIF_H+8))})
        for i, v in ipairs(notifStack) do if v == NF then table.remove(notifStack, i) break end end
        RepositionNotifs()
        task.wait(0.25); NG:Destroy()
    end

    XB.MouseButton1Click:Connect(Dismiss)
    task.delay(nDur, function() if NG.Parent then Dismiss() end end)

    if config.Actions then
        local ActRow = Frame(NF, UDim2.new(1,-16,0,22), UDim2.new(0,12,1,-28), Color3.new(0,0,0), 1)
        local AL = List(ActRow, 6, Enum.FillDirection.Horizontal)
        for _, act in ipairs(config.Actions) do
            local AB = Frame(ActRow, UDim2.new(0, GetTextW(act.Name,10)+16, 0, 22), nil, T.AccentDark, 0)
            Corner(AB, T.RadiusXs); Stroke(AB, T.Accent, 1, 0.4)
            Lbl(AB, act.Name, 10, T.Accent, Enum.Font.GothamMedium, Enum.TextXAlignment.Center).Size = UDim2.new(1,0,1,0)
            local ABB = Btn(AB)
            ABB.MouseButton1Click:Connect(function()
                if act.Callback then pcall(act.Callback) end
                Dismiss()
            end)
        end
        NF.Size = UDim2.new(0,290,0, NOTIF_H+28)
    end
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- DIALOG
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function NexusUI:Dialog(config)
    config = config or {}
    local DTitle   = config.Title   or "Dialog"
    local DContent = config.Content or ""
    local Buttons  = config.Buttons or {{Title="OK", Callback=function()end}}

    local DG = NewGui("NexusUI_Dialog", 1003)
    local Ov = Frame(DG, UDim2.new(1,0,1,0), nil, Color3.new(0,0,0), 0.55)

    local Card = Frame(DG, UDim2.new(0,400,0,0), UDim2.new(0.5,-200,0.5,0), T.Surface, 0)
    Card.AutomaticSize = Enum.AutomaticSize.Y; Card.AnchorPoint = Vector2.new(0,0.5)
    Corner(Card, T.Radius); Stroke(Card, T.Border); Shadow(Card, 0.3)
    Pad(Card, 22, 22, 22, 22); List(Card, 14)

    -- header
    local HRow = Frame(Card, UDim2.new(1,0,0,26), nil, Color3.new(0,0,0), 1); List(HRow, 0)
    local HL = Lbl(HRow, DTitle, 15, T.Text, Enum.Font.GothamBold); HL.Size = UDim2.new(1,0,0,26)
    Frame(Card, UDim2.new(1,0,0,1), nil, T.Separator, 0)

    -- body
    local BodyL = Lbl(Card, DContent, 12, T.TextDim, Enum.Font.Gotham)
    BodyL.Size = UDim2.new(1,0,0,0); BodyL.AutomaticSize = Enum.AutomaticSize.Y
    BodyL.TextWrapped = true; BodyL.TextYAlignment = Enum.TextYAlignment.Top

    Frame(Card, UDim2.new(1,0,0,1), nil, T.Separator, 0)

    -- buttons row
    local BRow = Frame(Card, UDim2.new(1,0,0,36), nil, Color3.new(0,0,0), 1)
    local BList = List(BRow, 8, Enum.FillDirection.Horizontal, Enum.HorizontalAlignment.Right, Enum.VerticalAlignment.Center)

    local function CloseDialog()
        Tw(Card, T.TMed, {Size=UDim2.new(0,400,0,0), BackgroundTransparency=1})
        Tw(Ov,   T.TMed, {BackgroundTransparency=1})
        task.wait(0.25); DG:Destroy()
    end

    for i, bCfg in ipairs(Buttons) do
        local isPrimary = (i == #Buttons)
        local BF = Frame(BRow, UDim2.new(0, GetTextW(bCfg.Title,12)+28, 0, 34),
            nil, isPrimary and T.Accent or T.ButtonBg, 0)
        Corner(BF, T.RadiusSm)
        if not isPrimary then Stroke(BF, T.Border) end
        Lbl(BF, bCfg.Title, 12, isPrimary and Color3.new(1,1,1) or T.Text,
            Enum.Font.GothamMedium, Enum.TextXAlignment.Center).Size = UDim2.new(1,0,1,0)
        local BB = Btn(BF)
        BB.MouseEnter:Connect(function()
            Tw(BF, T.TFast, {BackgroundColor3 = isPrimary and T.AccentHover or T.ButtonHover})
        end)
        BB.MouseLeave:Connect(function()
            Tw(BF, T.TFast, {BackgroundColor3 = isPrimary and T.Accent or T.ButtonBg})
        end)
        BB.MouseButton1Click:Connect(function()
            CloseDialog()
            if bCfg.Callback then pcall(bCfg.Callback) end
        end)
    end

    Card.Size = UDim2.new(0,400,0,0); Card.BackgroundTransparency = 1
    Tw(Card, T.TSpring, {BackgroundTransparency=0})
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- CREATE WINDOW
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function NexusUI:CreateWindow(config)
    config = config or {}
    local Title    = config.Title    or "NexusUI"
    local Subtitle = config.Subtitle or "v1.0"
    local ConfigSaving = config.ConfigurationSaving
    local IntroEnabled = config.IntroEnabled ~= false
    local IntroText    = config.IntroText or Title

    local Window = { _tabs={}, _active=nil, _conns={} }

    -- Config load
    local function SaveConfig()
        if ConfigSaving and ConfigSaving.FileName then
            local ok, data = pcall(function()
                local t = {}; for k,v in pairs(NexusUI.Flags) do t[k]=v end; return t
            end)
        end
    end

    local SG = NewGui("NexusUI_"..Title:gsub("%s",""), 999)

    -- Root
    local Root = Frame(SG,
        UDim2.new(0,T.WinW,0,T.WinH),
        UDim2.new(0.5,-T.WinW/2,0.5,-T.WinH/2),
        T.Background, 0
    )
    Root.Name = "NexusRoot"; Root.ClipsDescendants = true
    Corner(Root, T.Radius); Stroke(Root, T.Border)
    Shadow(Root, 0.3)

    -- â”€â”€ SIDEBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    local Sidebar = Frame(Root, UDim2.new(0,T.SidebarW,1,0), nil, T.Sidebar, 0)
    Sidebar.Name = "Sidebar"

    -- Logo mark
    local LogoOuter = Frame(Sidebar, UDim2.new(0,36,0,36), UDim2.new(0.5,-18,0,14), T.AccentDark, 0)
    Corner(LogoOuter, T.RadiusSm); Stroke(LogoOuter, T.Accent, 1, 0.3)
    local LogoL = Lbl(LogoOuter, "VhX", 17, T.Accent, Enum.Font.GothamBold, Enum.TextXAlignment.Center)
    LogoL.Size = UDim2.new(1,0,1,0)
    Frame(Sidebar, UDim2.new(0.6,0,0,1), UDim2.new(0.2,0,0,58), T.Separator, 0)

    -- icon list
    local IconList = Frame(Sidebar, UDim2.new(1,0,1,-70), UDim2.new(0,0,0,64), Color3.new(0,0,0), 1)
    IconList.ClipsDescendants = false
    List(IconList, 3, nil, Enum.HorizontalAlignment.Center)

    -- active bar
    local ActiveBar = Frame(Sidebar, UDim2.new(0,3,0,22), UDim2.new(0,0,0,0), T.Accent, 0)
    Corner(ActiveBar, T.RadiusFull); ActiveBar.Visible = false; ActiveBar.ZIndex = 6

    -- bottom bar
    local SideBot = Frame(Sidebar, UDim2.new(1,0,0,58), UDim2.new(0,0,1,-58), Color3.new(0,0,0), 1)
    Frame(SideBot, UDim2.new(0.6,0,0,1), UDim2.new(0.2,0,0,0), T.Separator, 0)
    local CloseF = Frame(SideBot, UDim2.new(0,32,0,32), UDim2.new(0.5,-16,0.5,-16), T.ButtonBg, 0)
    Corner(CloseF, T.RadiusSm); Stroke(CloseF, T.Border)
    local CL = Lbl(CloseF, "x", 19, T.TextDim, Enum.Font.GothamBold, Enum.TextXAlignment.Center)
    CL.Size = UDim2.new(1,0,1,0)
    local CB_ = Btn(CloseF)
    CB_.MouseEnter:Connect(function() Tw(CloseF, T.TFast, {BackgroundColor3=T.Danger}); Tw(CL, T.TFast, {TextColor3=Color3.new(1,1,1)}) end)
    CB_.MouseLeave:Connect(function() Tw(CloseF, T.TFast, {BackgroundColor3=T.ButtonBg}); Tw(CL, T.TFast, {TextColor3=T.TextDim}) end)
    CB_.MouseButton1Click:Connect(function() Window:Destroy() end)

    Frame(Root, UDim2.new(0,1,1,0), UDim2.new(0,T.SidebarW,0,0), T.Border, 0)

    -- â”€â”€ MAIN PANEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    local Main = Frame(Root, UDim2.new(1,-T.SidebarW-1,1,0), UDim2.new(0,T.SidebarW+1,0,0), Color3.new(0,0,0), 1)
    Main.ClipsDescendants = true

    -- Titlebar
    local TBar = Frame(Main, UDim2.new(1,0,0,50), nil, T.Surface, 0)
    Pad(TBar, 0, 14, 0, 18); MakeDraggable(TBar, Root)

    local TL  = Lbl(TBar, Title,    15, T.Text,    Enum.Font.GothamBold)
    TL.Size = UDim2.new(0.55,0,0,22); TL.Position = UDim2.new(0,0,0,8)
    local SL  = Lbl(TBar, Subtitle, 10, T.TextMuted, Enum.Font.Gotham)
    SL.Size = UDim2.new(0.55,0,0,14); SL.Position = UDim2.new(0,0,0,28)

    -- search bar
    local SearchF = Frame(TBar, UDim2.new(0,150,0,28), UDim2.new(0.5,-75,0.5,-14), T.InputBg, 0)
    Corner(SearchF, T.RadiusSm); Stroke(SearchF, T.Border)
    Pad(SearchF, 0, 10, 0, 10)
    local SearchTB = Instance.new("TextBox"); SearchTB.Size = UDim2.new(1,0,1,0)
    SearchTB.BackgroundTransparency = 1; SearchTB.Text = ""
    SearchTB.PlaceholderText = "ðŸ”  Search..."; SearchTB.PlaceholderColor3 = T.TextMuted
    SearchTB.TextColor3 = T.Text; SearchTB.TextSize = 11; SearchTB.Font = Enum.Font.Gotham
    SearchTB.ClearTextOnFocus = false; SearchTB.Parent = SearchF

    -- traffic lights
    local Ctrls = Frame(TBar, UDim2.new(0,66,0,20), UDim2.new(1,-66,0.5,-10), Color3.new(0,0,0), 1)
    List(Ctrls, 5, Enum.FillDirection.Horizontal, Enum.HorizontalAlignment.Right, Enum.VerticalAlignment.Center)
    local function MakeCtrl(col, action)
        local d = Frame(Ctrls, UDim2.new(0,13,0,13), nil, col, 0); Corner(d, T.RadiusFull)
        local b = Btn(d); b.MouseButton1Click:Connect(action)
        b.MouseEnter:Connect(function() Tw(d, T.TFast, {BackgroundTransparency=0.35}) end)
        b.MouseLeave:Connect(function() Tw(d, T.TFast, {BackgroundTransparency=0}) end)
    end
    MakeCtrl(Color3.fromRGB(255,92,84),  function() Window:Destroy() end)
    MakeCtrl(Color3.fromRGB(255,185,44), function() Root.Visible = not Root.Visible end)
    MakeCtrl(Color3.fromRGB(38,196,58),  function() end)

    Frame(Main, UDim2.new(1,0,0,1), UDim2.new(0,0,0,50), T.Separator, 0)

    -- Content
    local Content = Frame(Main, UDim2.new(1,0,1,-51), UDim2.new(0,0,0,51), Color3.new(0,0,0), 1)
    Content.ClipsDescendants = true

    -- Search filter logic
    local allElements = {}
    SearchTB:GetPropertyChangedSignal("Text"):Connect(function()
        local query = SearchTB.Text:lower()
        for _, el in ipairs(allElements) do
            if el.SearchLabel and el.Frame then
                local match = el.SearchLabel:lower():find(query, 1, true)
                el.Frame.Visible = (query == "") or (match ~= nil)
            end
        end
    end)

    -- â”€â”€ CREATE TAB â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function Window:CreateTab(cfg)
        cfg = cfg or {}
        local TabName = cfg.Name or "Tab"
        local TabIcon = cfg.Icon or "rbxassetid://10723407389"

        local Tab = {}

        local IBtn = Frame(IconList, UDim2.new(0,38,0,38), nil, Color3.new(0,0,0), 1)
        IBtn.ClipsDescendants = false; Corner(IBtn, T.RadiusSm)
        local IImg = Instance.new("ImageLabel"); IImg.Size = UDim2.new(0,18,0,18)
        IImg.AnchorPoint = Vector2.new(0.5,0.5); IImg.Position = UDim2.new(0.5,0,0.5,0)
        IImg.BackgroundTransparency = 1; IImg.Image = TabIcon
        IImg.ImageColor3 = T.SidebarIcon; IImg.ZIndex = 3; IImg.Parent = IBtn

        -- tooltip
        local TT = Frame(IBtn, UDim2.new(0,10,0,26), UDim2.new(1,8,0.5,-13), T.SurfaceLight, 0)
        TT.Visible = false; TT.ZIndex = 12; Corner(TT, T.RadiusXs); Stroke(TT, T.Border)
        local TTL = Lbl(TT, TabName, 10, T.Text, Enum.Font.GothamMedium)
        TTL.Size = UDim2.new(1,-10,1,0); TTL.Position = UDim2.new(0,5,0,0); TTL.ZIndex = 13

        local IB = Btn(IBtn); IB.ZIndex = 4

        -- tab frame
        local TF = Frame(Content, UDim2.new(1,0,1,0), nil, Color3.new(0,0,0), 1)
        TF.Name = "TF_"..TabName; TF.Visible = false; TF.ClipsDescendants = true

        local Scroll = Instance.new("ScrollingFrame"); Scroll.Size = UDim2.new(1,0,1,0)
        Scroll.BackgroundTransparency = 1; Scroll.BorderSizePixel = 0
        Scroll.ScrollBarThickness = 3; Scroll.ScrollBarImageColor3 = T.Accent
        Scroll.CanvasSize = UDim2.new(0,0,0,0); Scroll.AutomaticCanvasSize = Enum.AutomaticCanvasSize.Y
        Scroll.ScrollingDirection = Enum.ScrollingDirection.Y; Scroll.Parent = TF
        Pad(Scroll, 12, 12, 12, 12); List(Scroll, 10)

        local active = false
        local function SetActive(v)
            active = v
            if v then
                Tw(IBtn, T.TFast, {BackgroundColor3=T.AccentGlow, BackgroundTransparency=0.45})
                Tw(IImg, T.TFast, {ImageColor3=T.Accent})
                ActiveBar.Visible = true
            else
                Tw(IBtn, T.TFast, {BackgroundColor3=Color3.new(0,0,0), BackgroundTransparency=1})
                Tw(IImg, T.TFast, {ImageColor3=T.SidebarIcon})
            end
        end

        IBtn:GetPropertyChangedSignal("AbsolutePosition"):Connect(function()
            local rel = IBtn.AbsolutePosition.Y - Sidebar.AbsolutePosition.Y
            ActiveBar.Position = UDim2.new(0,0,0,rel+8)
        end)

        IB.MouseEnter:Connect(function()
            if not active then
                Tw(IBtn, T.TFast, {BackgroundColor3=T.SurfaceLight, BackgroundTransparency=0})
                Tw(IImg, T.TFast, {ImageColor3=T.TextDim})
            end
            local tw = GetTextW(TabName, 10, Enum.Font.GothamMedium)
            TT.Size = UDim2.new(0,tw+10,0,26); TT.Visible = true
        end)
        IB.MouseLeave:Connect(function()
            if not active then
                Tw(IBtn, T.TFast, {BackgroundColor3=Color3.new(0,0,0), BackgroundTransparency=1})
                Tw(IImg, T.TFast, {ImageColor3=T.SidebarIcon})
            end
            TT.Visible = false
        end)
        IB.MouseButton1Click:Connect(function()
            if Window._active then
                Window._active._setActive(false); Window._active._frame.Visible = false
            end
            SetActive(true); TF.Visible = true
            Window._active = {_setActive=SetActive, _frame=TF}
            TT.Visible = false
        end)

        Tab._setActive = SetActive; Tab._frame = TF; Tab._scroll = Scroll
        table.insert(Window._tabs, Tab)
        if #Window._tabs == 1 then
            SetActive(true); TF.Visible = true
            Window._active = {_setActive=SetActive, _frame=TF}
        end

        -- â”€â”€ CREATE SECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        function Tab:CreateSection(cfg2)
            cfg2 = cfg2 or {}
            local SName = cfg2.Name or "Section"
            local Section = {}

            local SF = Frame(Scroll, UDim2.new(1,0,0,0), nil, T.SectionBg, 0)
            SF.AutomaticSize = Enum.AutomaticSize.Y; SF.Name = "S_"..SName
            Corner(SF, T.RadiusSm); Stroke(SF, T.Border)
            Pad(SF, 10, 12, 12, 12); List(SF, 8)

            local HR = Frame(SF, UDim2.new(1,0,0,20), nil, Color3.new(0,0,0), 1); HR.LayoutOrder = -1
            local SL_ = Lbl(HR, SName:upper(), 9, T.TextMuted, Enum.Font.GothamBold)
            SL_.Size = UDim2.new(1,0,1,0)
            Frame(SF, UDim2.new(1,0,0,1), nil, T.Separator, 0).LayoutOrder = 0

            local function AddEl(frame, lbl_) table.insert(allElements, {Frame=frame, SearchLabel=lbl_}) end

            -- â”€â”€ BUTTON â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            function Section:CreateButton(cfg3)
                cfg3 = cfg3 or {}
                local BN = cfg3.Name or "Button"; local BD = cfg3.Description or ""
                local BC = cfg3.Callback or function() end

                local BF = Frame(SF, UDim2.new(1,0,0,42), nil, T.ButtonBg, 0)
                BF.ClipsDescendants = true; Corner(BF, T.RadiusXs); Stroke(BF, T.Border)
                Pad(BF, 0,12,0,12)

                local BL = Lbl(BF, BN, 13, T.Text, Enum.Font.GothamMedium)
                BL.Size = UDim2.new(1,-24,0,42)
                if BD ~= "" then
                    BL.Size = UDim2.new(1,-24,0,22); BL.Position = UDim2.new(0,0,0,4)
                    local DL = Lbl(BF, BD, 10, T.TextMuted, Enum.Font.Gotham)
                    DL.Size = UDim2.new(1,-24,0,14); DL.Position = UDim2.new(0,0,0,24)
                end
                local AL = Lbl(BF, "â€º", 17, T.TextMuted, Enum.Font.GothamBold, Enum.TextXAlignment.Right)
                AL.Size = UDim2.new(0,18,0,42); AL.Position = UDim2.new(1,-18,0,0)

                local BB = Btn(BF)
                BB.MouseEnter:Connect(function() Tw(BF,T.TFast,{BackgroundColor3=T.ButtonHover}); Tw(AL,T.TFast,{TextColor3=T.Accent}) end)
                BB.MouseLeave:Connect(function() Tw(BF,T.TFast,{BackgroundColor3=T.ButtonBg}); Tw(AL,T.TFast,{TextColor3=T.TextMuted}) end)
                BB.MouseButton1Down:Connect(function() Tw(BF,T.TFast,{BackgroundColor3=T.ButtonClick}) end)
                BB.MouseButton1Click:Connect(function() Ripple(BF); Tw(BF,T.TFast,{BackgroundColor3=T.ButtonHover}); pcall(BC) end)
                AddEl(BF, BN)

                return { SetText=function(_,t) BL.Text=t end, SetCallback=function(_,c) BC=c end }
            end

            -- â”€â”€ TOGGLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            function Section:CreateToggle(cfg3)
                cfg3 = cfg3 or {}
                local TN = cfg3.Name or "Toggle"; local TD = cfg3.Description or ""
                local flag = cfg3.Flag or ""; local state = cfg3.CurrentValue or cfg3.Default or false
                local TC = cfg3.Callback or function() end
                SetFlag(flag, state)

                local TF_ = Frame(SF, UDim2.new(1,0,0,42), nil, T.ButtonBg, 0)
                TF_.ClipsDescendants = true; Corner(TF_, T.RadiusXs); Stroke(TF_, T.Border)
                Pad(TF_, 0,12,0,12)
                local TL_ = Lbl(TF_, TN, 13, T.Text, Enum.Font.GothamMedium)
                TL_.Size = UDim2.new(1,-54,0,42)
                if TD ~= "" then
                    TL_.Size = UDim2.new(1,-54,0,22); TL_.Position = UDim2.new(0,0,0,4)
                    local DL = Lbl(TF_, TD, 10, T.TextMuted, Enum.Font.Gotham)
                    DL.Size = UDim2.new(1,-54,0,14); DL.Position = UDim2.new(0,0,0,24)
                end

                local Track = Frame(TF_, UDim2.new(0,40,0,22), UDim2.new(1,-40,0.5,-11), T.ToggleOff, 0)
                Corner(Track, T.RadiusFull); Stroke(Track, T.Border)
                local Thumb = Frame(Track, UDim2.new(0,16,0,16), UDim2.new(0,3,0.5,-8), Color3.new(1,1,1), 0)
                Corner(Thumb, T.RadiusFull)

                local function Set(v, silent)
                    state = v; SetFlag(flag, v)
                    if v then
                        Tw(Track, T.TMed, {BackgroundColor3=T.ToggleOn})
                        Tw(Thumb, T.TMed, {Position=UDim2.new(0,21,0.5,-8)})
                    else
                        Tw(Track, T.TMed, {BackgroundColor3=T.ToggleOff})
                        Tw(Thumb, T.TMed, {Position=UDim2.new(0,3,0.5,-8)})
                    end
                    if not silent then pcall(TC, state) end
                end
                if state then Set(true, true) end

                local TB_ = Btn(TF_)
                TB_.MouseEnter:Connect(function() Tw(TF_,T.TFast,{BackgroundColor3=T.ButtonHover}) end)
                TB_.MouseLeave:Connect(function() Tw(TF_,T.TFast,{BackgroundColor3=T.ButtonBg}) end)
                TB_.MouseButton1Click:Connect(function() Set(not state) end)
                AddEl(TF_, TN)

                return { SetValue=function(_,v) Set(v,false) end, GetValue=function() return state end }
            end

            -- â”€â”€ SLIDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            function Section:CreateSlider(cfg3)
                cfg3 = cfg3 or {}
                local SN = cfg3.Name or "Slider"; local SD = cfg3.Description or ""
                local SRange = cfg3.Range or {0,100}; local SInc = cfg3.Increment or 1
                local SCV = cfg3.CurrentValue or cfg3.Default or SRange[1]
                local flag = cfg3.Flag or ""; local SC = cfg3.Callback or function() end
                local suffix = cfg3.Suffix or ""
                SCV = math.clamp(SCV, SRange[1], SRange[2]); SetFlag(flag, SCV)

                local SlidF = Frame(SF, UDim2.new(1,0,0,52), nil, T.ButtonBg, 0)
                Corner(SlidF, T.RadiusXs); Stroke(SlidF, T.Border); Pad(SlidF, 8,12,10,12)

                local TopRow = Frame(SlidF, UDim2.new(1,0,0,20), nil, Color3.new(0,0,0), 1)
                local NameL = Lbl(TopRow, SN, 13, T.Text, Enum.Font.GothamMedium); NameL.Size = UDim2.new(0.7,0,1,0)
                local ValL  = Lbl(TopRow, tostring(SCV)..suffix, 13, T.Accent, Enum.Font.GothamBold, Enum.TextXAlignment.Right)
                ValL.Size = UDim2.new(0.3,0,1,0)

                local Track = Frame(SlidF, UDim2.new(1,0,0,6), UDim2.new(0,0,1,-6), T.SliderBg, 0)
                Corner(Track, T.RadiusFull)
                local Fill = Frame(Track, UDim2.new(0,0,1,0), nil, T.SliderFill, 0); Corner(Fill, T.RadiusFull)
                local Knob = Frame(Track, UDim2.new(0,14,0,14), UDim2.new(0,0,0.5,-7), Color3.new(1,1,1), 0)
                Corner(Knob, T.RadiusFull); Stroke(Knob, T.Accent, 2)

                local function UpdateSlider(v)
                    v = math.clamp(math.round((v - SRange[1]) / SInc) * SInc + SRange[1], SRange[1], SRange[2])
                    SCV = v; SetFlag(flag, v)
                    local pct = (v - SRange[1]) / (SRange[2] - SRange[1])
                    ValL.Text = tostring(v)..suffix
                    Tw(Fill, T.TFast, {Size = UDim2.new(pct, 0, 1, 0)})
                    Tw(Knob, T.TFast, {Position = UDim2.new(pct, -7, 0.5, -7)})
                    pcall(SC, v)
                end
                UpdateSlider(SCV)

                local dragging = false
                local SlideBtn = Btn(Track); SlideBtn.ZIndex = 4
                SlideBtn.MouseButton1Down:Connect(function() dragging = true end)
                UserInputService.InputEnded:Connect(function(i)
                    if i.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
                end)
                UserInputService.InputChanged:Connect(function(i)
                    if dragging and i.UserInputType == Enum.UserInputType.MouseMovement then
                        local absPos = Track.AbsolutePosition.X
                        local absSize = Track.AbsoluteSize.X
                        local pct = math.clamp((Mouse.X - absPos) / absSize, 0, 1)
                        local val = SRange[1] + (SRange[2]-SRange[1]) * pct
                        UpdateSlider(val)
                    end
                end)
                Track.MouseEnter:Connect(function() Tw(Knob, T.TFast, {Size=UDim2.new(0,18,0,18), Position=UDim2.new((SCV-SRange[1])/(SRange[2]-SRange[1]),-9,0.5,-9)}) end)
                Track.MouseLeave:Connect(function() if not dragging then Tw(Knob, T.TFast, {Size=UDim2.new(0,14,0,14)}) end end)
                AddEl(SlidF, SN)

                return { SetValue=function(_,v) UpdateSlider(v) end, GetValue=function() return SCV end }
            end

            -- â”€â”€ INPUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            function Section:CreateInput(cfg3)
                cfg3 = cfg3 or {}
                local IN = cfg3.Name or "Input"; local PH = cfg3.PlaceholderText or "Type here..."
                local clearOnFocus = cfg3.RemoveTextAfterFocusLost ~= false
                local flag = cfg3.Flag or ""; local IC = cfg3.Callback or function() end

                local IF = Frame(SF, UDim2.new(1,0,0,52), nil, T.ButtonBg, 0)
                Corner(IF, T.RadiusXs); Stroke(IF, T.Border); Pad(IF, 8,12,8,12)

                local NL = Lbl(IF, IN, 12, T.TextDim, Enum.Font.GothamMedium); NL.Size = UDim2.new(1,0,0,16); NL.Position = UDim2.new(0,0,0,0)

                local InputOuter = Frame(IF, UDim2.new(1,0,0,26), UDim2.new(0,0,0,20), T.InputBg, 0)
                Corner(InputOuter, T.RadiusXs); Stroke(InputOuter, T.Border)
                Pad(InputOuter, 0, 8, 0, 8)
                local TB_ = Instance.new("TextBox"); TB_.Size = UDim2.new(1,0,1,0)
                TB_.BackgroundTransparency = 1; TB_.Text = cfg3.CurrentValue or ""
                TB_.PlaceholderText = PH; TB_.PlaceholderColor3 = T.TextMuted
                TB_.TextColor3 = T.Text; TB_.TextSize = 12; TB_.Font = Enum.Font.Gotham
                TB_.ClearTextOnFocus = false; TB_.Parent = InputOuter

                TB_.Focused:Connect(function()
                    Stroke(InputOuter):Destroy(); Stroke(InputOuter, T.Accent)
                    Tw(InputOuter, T.TFast, {BackgroundColor3=Color3.fromRGB(20,18,36)})
                end)
                TB_.FocusLost:Connect(function(enter)
                    Stroke(InputOuter):Destroy(); Stroke(InputOuter, T.Border)
                    Tw(InputOuter, T.TFast, {BackgroundColor3=T.InputBg})
                    SetFlag(flag, TB_.Text); pcall(IC, TB_.Text)
                    if clearOnFocus and enter then TB_.Text = "" end
                end)
                AddEl(IF, IN)

                return {
                    SetValue=function(_,v) TB_.Text=v; SetFlag(flag,v) end,
                    GetValue=function() return TB_.Text end
                }
            end

            -- â”€â”€ DROPDOWN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            function Section:CreateDropdown(cfg3)
                cfg3 = cfg3 or {}
                local DN = cfg3.Name or "Dropdown"; local DD = cfg3.Description or ""
                local Opts = cfg3.Options or {}; local Multi = cfg3.MultipleOptions or false
                local flag = cfg3.Flag or ""; local DC = cfg3.Callback or function() end
                local current = cfg3.CurrentOption or (Multi and {} or (Opts[1] or ""))
                SetFlag(flag, current)

                local DDF = Frame(SF, UDim2.new(1,0,0,0), nil, T.ButtonBg, 0)
                DDF.AutomaticSize = Enum.AutomaticSize.Y; DDF.Name = "DD_"..DN
                Corner(DDF, T.RadiusXs); Stroke(DDF, T.Border); Pad(DDF, 8,12,8,12)

                local NL = Lbl(DDF, DN, 12, T.TextDim, Enum.Font.GothamMedium); NL.Size = UDim2.new(1,0,0,16)

                local ValRow = Frame(DDF, UDim2.new(1,0,0,32), UDim2.new(0,0,0,20), T.InputBg, 0)
                Corner(ValRow, T.RadiusXs); Stroke(ValRow, T.Border); Pad(ValRow, 0,10,0,10)

                local CurL = Lbl(ValRow, Multi and table.concat(current,", ") or tostring(current), 12, T.Text, Enum.Font.GothamMedium)
                CurL.Size = UDim2.new(1,-18,1,0)
                local ArrowL = Lbl(ValRow, "â–¾", 11, T.TextMuted, Enum.Font.GothamBold, Enum.TextXAlignment.Right)
                ArrowL.Size = UDim2.new(0,18,1,0); ArrowL.Position = UDim2.new(1,-18,0,0)

                -- options container
                local OptCont = Frame(DDF, UDim2.new(1,0,0,0), nil, T.InputBg, 0)
                OptCont.AutomaticSize = Enum.AutomaticSize.Y; OptCont.Visible = false
                Corner(OptCont, T.RadiusXs); Stroke(OptCont, T.Accent, 1, 0.5)
                Pad(OptCont, 4,4,4,4); List(OptCont, 2)

                local isOpen = false
                local OpenBtn = Btn(ValRow)

                local function UpdateDisplay()
                    if Multi then CurL.Text = #current > 0 and table.concat(current,", ") or "None"
                    else CurL.Text = tostring(current) end
                end

                local function BuildOptions()
                    for _, c in ipairs(OptCont:GetChildren()) do
                        if c:IsA("Frame") then c:Destroy() end
                    end
                    for _, opt in ipairs(Opts) do
                        local isSelected = Multi and (table.find(current, opt) ~= nil) or (current == opt)
                        local OF = Frame(OptCont, UDim2.new(1,0,0,28), nil, isSelected and T.AccentDark or Color3.new(0,0,0), isSelected and 0 or 1)
                        Corner(OF, T.RadiusXs); Pad(OF, 0,6,0,6)
                        if isSelected then Stroke(OF, T.Accent, 1, 0.6) end
                        local OL = Lbl(OF, opt, 12, isSelected and T.Accent or T.Text, Enum.Font.GothamMedium)
                        OL.Size = UDim2.new(1,-16,1,0)
                        if isSelected then
                            local CK = Lbl(OF, "âœ“", 11, T.Accent, Enum.Font.GothamBold, Enum.TextXAlignment.Right)
                            CK.Size = UDim2.new(0,16,1,0); CK.Position = UDim2.new(1,-16,0,0)
                        end
                        local OBtn = Btn(OF)
                        OBtn.MouseEnter:Connect(function() if not isSelected then Tw(OF, T.TFast, {BackgroundTransparency=0, BackgroundColor3=T.SurfaceHover}) end end)
                        OBtn.MouseLeave:Connect(function() if not isSelected then Tw(OF, T.TFast, {BackgroundTransparency=1}) end end)
                        OBtn.MouseButton1Click:Connect(function()
                            if Multi then
                                local idx = table.find(current, opt)
                                if idx then table.remove(current, idx) else table.insert(current, opt) end
                            else current = opt; isOpen = false; OptCont.Visible = false; Tw(ArrowL,T.TFast,{Rotation=0}) end
                            SetFlag(flag, current); UpdateDisplay(); BuildOptions(); pcall(DC, current)
                        end)
                    end
                end
                BuildOptions()

                OpenBtn.MouseButton1Click:Connect(function()
                    isOpen = not isOpen; OptCont.Visible = isOpen
                    Tw(ArrowL, T.TFast, {Rotation = isOpen and 180 or 0})
                    Tw(ValRow, T.TFast, {BackgroundColor3 = isOpen and Color3.fromRGB(20,18,36) or T.InputBg})
                end)
                AddEl(DDF, DN)

                return {
                    SetValue=function(_,v) current=v; SetFlag(flag,v); UpdateDisplay(); BuildOptions() end,
                    GetValue=function() return current end,
                    Refresh=function(_,opts) Opts=opts; BuildOptions() end
                }
            end

            -- â”€â”€ COLOR PICKER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            function Section:CreateColorPicker(cfg3)
                cfg3 = cfg3 or {}
                local CN = cfg3.Name or "Color"; local flag = cfg3.Flag or ""
                local CurColor = cfg3.Color or Color3.fromRGB(255,100,100)
                local CC = cfg3.Callback or function() end
                SetFlag(flag, CurColor)

                local CPF = Frame(SF, UDim2.new(1,0,0,0), nil, T.ButtonBg, 0)
                CPF.AutomaticSize = Enum.AutomaticSize.Y; Corner(CPF, T.RadiusXs); Stroke(CPF, T.Border)
                Pad(CPF, 8,12,8,12)

                local HeaderRow = Frame(CPF, UDim2.new(1,0,0,32), nil, Color3.new(0,0,0), 1)
                local NL = Lbl(HeaderRow, CN, 13, T.Text, Enum.Font.GothamMedium); NL.Size = UDim2.new(1,-44,1,0)
                local Swatch = Frame(HeaderRow, UDim2.new(0,32,0,22), UDim2.new(1,-32,0.5,-11), CurColor, 0)
                Corner(Swatch, T.RadiusXs); Stroke(Swatch, T.Border)

                local isOpen = false
                local PickerBody = Frame(CPF, UDim2.new(1,0,0,0), nil, Color3.new(0,0,0), 1)
                PickerBody.AutomaticSize = Enum.AutomaticSize.Y; PickerBody.Visible = false

                -- Hue/Sat/Val sliders
                local function MakeColorSlider(lbl, col)
                    local row = Frame(PickerBody, UDim2.new(1,0,0,28), nil, Color3.new(0,0,0), 1)
                    Lbl(row, lbl, 10, T.TextDim, Enum.Font.Gotham).Size = UDim2.new(0,12,1,0)
                    local track = Frame(row, UDim2.new(1,-40,0,6), UDim2.new(14,0,0.5,-3), col, 0)
                    Corner(track, T.RadiusFull)
                    local knob = Frame(track, UDim2.new(0,12,0,12), UDim2.new(0,-6,0.5,-6), Color3.new(1,1,1), 0)
                    Corner(knob, T.RadiusFull); Stroke(knob, T.Border, 1)
                    local valL = Lbl(row, "255", 10, T.Text, Enum.Font.GothamMedium, Enum.TextXAlignment.Right)
                    valL.Size = UDim2.new(0,28,1,0); valL.Position = UDim2.new(1,-28,0,0)
                    return track, knob, valL
                end

                local hue, sat, val = Color3.toHSV(CurColor)
                local HTrack, HKnob, HVal = MakeColorSlider("H", Color3.fromHSV(0,1,1))
                local STrack, SKnob, SVal = MakeColorSlider("S", Color3.fromHSV(hue,1,1))
                local VTrack, VKnob, VVal = MakeColorSlider("V", Color3.fromHSV(hue,sat,1))

                local function ApplyColor()
                    CurColor = Color3.fromHSV(hue,sat,val)
                    Swatch.BackgroundColor3 = CurColor
                    SetFlag(flag, CurColor); pcall(CC, CurColor)
                end

                local function MakeDrag(track, knob, onMove)
                    local d = false
                    Btn(track).MouseButton1Down:Connect(function() d=true end)
                    UserInputService.InputEnded:Connect(function(i)
                        if i.UserInputType == Enum.UserInputType.MouseButton1 then d=false end
                    end)
                    UserInputService.InputChanged:Connect(function(i)
                        if d and i.UserInputType == Enum.UserInputType.MouseMovement then
                            local p = math.clamp((Mouse.X-track.AbsolutePosition.X)/track.AbsoluteSize.X,0,1)
                            Tw(knob,T.TFast,{Position=UDim2.new(p,-6,0.5,-6)}); onMove(p)
                        end
                    end)
                end

                MakeDrag(HTrack,HKnob,function(p) hue=p; HVal.Text=tostring(math.round(p*360)); ApplyColor() end)
                MakeDrag(STrack,SKnob,function(p) sat=p; SVal.Text=tostring(math.round(p*100)).."%"; ApplyColor() end)
                MakeDrag(VTrack,VKnob,function(p) val=p; VVal.Text=tostring(math.round(p*100)).."%"; ApplyColor() end)

                local TogBtn = Btn(HeaderRow)
                TogBtn.MouseButton1Click:Connect(function()
                    isOpen = not isOpen; PickerBody.Visible = isOpen
                    Tw(Swatch, T.TFast, {BackgroundTransparency = isOpen and 0.3 or 0})
                end)
                AddEl(CPF, CN)

                return {
                    SetValue=function(_,c) CurColor=c; local h,s,v2=Color3.toHSV(c); hue=h;sat=s;val=v2; Swatch.BackgroundColor3=c; SetFlag(flag,c) end,
                    GetValue=function() return CurColor end
                }
            end

            -- â”€â”€ KEYBIND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            function Section:CreateKeybind(cfg3)
                cfg3 = cfg3 or {}
                local KN = cfg3.Name or "Keybind"; local flag = cfg3.Flag or ""
                local curKey = cfg3.CurrentKeybind or Enum.KeyCode.Unknown
                local hold = cfg3.HoldToInteract or false
                local KC = cfg3.Callback or function() end
                SetFlag(flag, curKey)

                local KF = Frame(SF, UDim2.new(1,0,0,42), nil, T.ButtonBg, 0)
                Corner(KF, T.RadiusXs); Stroke(KF, T.Border); Pad(KF, 0,12,0,12)
                local KL = Lbl(KF, KN, 13, T.Text, Enum.Font.GothamMedium); KL.Size = UDim2.new(1,-80,0,42)

                local KeyF = Frame(KF, UDim2.new(0,70,0,26), UDim2.new(1,-70,0.5,-13), T.InputBg, 0)
                Corner(KeyF, T.RadiusXs); Stroke(KeyF, T.Border)
                local KeyL = Lbl(KeyF, curKey == Enum.KeyCode.Unknown and "None" or curKey.Name, 11, T.Accent, Enum.Font.GothamMedium, Enum.TextXAlignment.Center)
                KeyL.Size = UDim2.new(1,0,1,0)

                local binding = false
                local KB = Btn(KF)
                KB.MouseButton1Click:Connect(function()
                    binding = true; KeyL.Text = "..."; Tw(KeyF, T.TFast, {BackgroundColor3=T.AccentDark})
                end)

                UserInputService.InputBegan:Connect(function(i, gp)
                    if gp then return end
                    if binding then
                        binding = false; curKey = i.KeyCode
                        KeyL.Text = curKey == Enum.KeyCode.Unknown and "None" or curKey.Name
                        Tw(KeyF, T.TFast, {BackgroundColor3=T.InputBg})
                        SetFlag(flag, curKey); pcall(KC, curKey)
                    elseif i.KeyCode == curKey then
                        if not hold then pcall(KC, curKey) end
                    end
                end)
                AddEl(KF, KN)

                return {
                    SetValue=function(_,k) curKey=k; KeyL.Text=k==Enum.KeyCode.Unknown and "None" or k.Name; SetFlag(flag,k) end,
                    GetValue=function() return curKey end
                }
            end

            -- â”€â”€ LABEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            function Section:CreateLabel(cfg3)
                cfg3 = cfg3 or {}
                local LF = Frame(SF, UDim2.new(1,0,0,26), nil, Color3.new(0,0,0), 1)
                local LL = Lbl(LF, cfg3.Name or "Label", 11, T.TextDim, Enum.Font.Gotham)
                LL.Size = UDim2.new(1,0,1,0)
                return { SetText=function(_,t) LL.Text=t end }
            end

            -- â”€â”€ PARAGRAPH â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            function Section:CreateParagraph(cfg3)
                cfg3 = cfg3 or {}
                local PF = Frame(SF, UDim2.new(1,0,0,0), nil, T.SurfaceLight, 0)
                PF.AutomaticSize = Enum.AutomaticSize.Y; Corner(PF, T.RadiusXs); Pad(PF, 8,10,8,10)
                local TitleL = Lbl(PF, cfg3.Title or "", 12, T.Text, Enum.Font.GothamBold)
                TitleL.Size = UDim2.new(1,0,0,18)
                local BodyL  = Lbl(PF, cfg3.Content or "", 11, T.TextDim, Enum.Font.Gotham)
                BodyL.Size = UDim2.new(1,0,0,0); BodyL.AutomaticSize = Enum.AutomaticSize.Y
                BodyL.TextWrapped = true; BodyL.TextYAlignment = Enum.TextYAlignment.Top
                BodyL.Position = UDim2.new(0,0,0,20)
                return {
                    SetTitle=function(_,t) TitleL.Text=t end,
                    SetContent=function(_,c) BodyL.Text=c end
                }
            end

            return Section
        end

        return Tab
    end

    -- â”€â”€ NOTIFY (alias) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function Window:Notify(cfg) NexusUI:Notify(cfg) end

    -- â”€â”€ DIALOG (alias) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function Window:Dialog(cfg) NexusUI:Dialog(cfg) end

    -- â”€â”€ DESTROY / UNLOAD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function Window:Destroy()
        Tw(Root, T.TMed, {Size=UDim2.new(0,T.WinW,0,0), BackgroundTransparency=1})
        task.wait(0.25)
        for _, c in ipairs(Window._conns) do
            if type(c)=="table" and c.destroy then c.destroy()
            elseif typeof(c)=="RBXScriptConnection" then c:Disconnect() end
        end
        SaveConfig(); SG:Destroy()
    end
    Window.Unload = Window.Destroy

    -- open animation
    Root.Size = UDim2.new(0,T.WinW,0,0); Root.BackgroundTransparency = 1
    Tw(Root, T.TSpring, {Size=UDim2.new(0,T.WinW,0,T.WinH), BackgroundTransparency=0})

    return Window
end

return NexusUI
